knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
#if (!requireNamespace("BiocManager", quietly = TRUE))
#    install.packages("BiocManager")
#BiocManager::install("Biostrings")
#if (!requireNamespace("BiocManager", quietly = TRUE))
#    install.packages("BiocManager")
#BiocManager::install("ggtree")
#if (!requireNamespace("BiocManager", quietly = TRUE))
#    install.packages("BiocManager")
#BiocManager::install("DECIPHER")
library(seqinr)
library(ggplot2)
library(ggthemes)
library(DECIPHER)
library(Biostrings)
library(adegenet)
library(ape)
library(ggtree)
library(viridis)
virus <-c("ON402862","MZ054387","MK303619","KX154684","KP887098","GU553363","AY597011","MT385459","KF512645","KY688123","MZ682627","DQ462754","FJ656171","KC294433","KM077085","KT359907","KM055542","LC488390","KX285715","KX179494")
virus_sequences <- read.GenBank(virus)
str(virus_sequences)
write.dna(virus_sequences,  file ="virus_seqs.fasta", format = "fasta", append =
FALSE, nbcol = 6, colsep = " ", colw = 10)
virus_sequences <-read.fasta("virus_seqs.fasta")
virus_names = names(virus_sequences)
for (i in 1:length(virus_sequences)){
print(paste(virus_names[i],length(virus_sequences[[i]]),sep="= "))
}
set = rbind()
seta = rbind()
setc = rbind()
setg = rbind()
sett = rbind()
for(i in 1:20){
s=count(virus_sequences[[i]],1)
set=cbind(set,(s))
seta = cbind(seta,s[1])
setc = cbind(setc,s[2])
setg = cbind(setg,s[3])
sett = cbind(sett,s[4])
}
barp=barplot(set,main = "Comparacion general de nucleotidos",legend=T,col=c("#E51932","#32FF00","#FFFF32","#654CFF"), names.arg=virus_names,las=2)
barp=barplot(seta,main = "Comparacion a",legend=T,col="#E51932", names.arg=virus_names,las=2)
barp=barplot(setc,main = "Comparacion c",legend=T,col="#32FF00", names.arg=virus_names,las=2)
barp=barplot(setg,main = "Comparacion g",legend=T,col="#FFFF32", names.arg=virus_names,las=2)
barp=barplot(sett,main = "Comparacion t",legend=T,col="#654CFF", names.arg=virus_names,las=2)
virus_seq_not_align <-readDNAStringSet("virus_seqs.fasta", format = "fasta")
virus_seq_not_align
#virus_seq_not_align <- OrientNucleotides(virus_seq_not_align)
#virus_seq_align <- AlignSeqs(virus_seq_not_align)
#writeXStringSet(virus_seq_align, file="virus_seq_align.fasta")
virus_seq_align <- read.alignment("virus_seq_align.fasta", format = "fasta")
#BrowseSeqs(virus_seq_align, highlight=0)
matriz_distancia <- dist.alignment(virus_align, matrix = "similarity")
matriz_distancia <- dist.alignment(virus_seq_align, matrix = "similarity")
virus_tree <- njs(matriz_distancia)
virus_tree <- ladderize(virus_tree)
plot(virus_tree, cex = 0.6)
title("Tipos de coronavirus")
